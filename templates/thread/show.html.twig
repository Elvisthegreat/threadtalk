{% extends 'base.html.twig'%}

{% block body %}
	<div class="overlay"></div>
	<section class="container my-3">
		<div class="row">
			<div class="col-12 col-lg-6 my-3">
				<div class="card h-100">
					<div class="card-body">
						<h5 class="card-title">{{ thread.title }}</h5>
						<p class="card-text">{{ thread.description }}</p>
						<small class="text-muted">{{ thread.createdAt|date('Y-m-d H:i') }}</small>
						<a href="{{ path('thread_edit', {'id' : thread.id}) }}" class="btn btn-sm btn-outline-primary shadow-sm px-2">Edit Trend</a>
						<a href="{{ path('thread_delete', {'id' : thread.id}) }}" class="btn btn-sm btn-outline-primary shadow-sm px-2 btn-hover">Delete Trend</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Comments Section -->
		<div class="mt-4">
			<h3 class="mb-4">Comments</h3>
			{% for comment in thread.comments %}
				<div class="card mb-3 shadow-sm">
					<div class="card-body d-flex align-items-start">
						<div class="me-3">
							<div class="rounded-circle bg-secondary text-white text-center fw-bold" style="width:40px; height:40px; line-height:40px;">
								{{ comment.author.username|slice(0, 1)|upper }}
							</div>
						</div>
						<div>
							<div class="fw-bold mb-1">
								{{ comment.author.username }}
							</div>
							<p class="mb-1">{{ comment.content }}</p>
							{% if app.user and app.user.id == comment.author.id %}
								<button class="btn-edit btn btn-sm btn-outline-primary" data-comment_id="{{ comment.id }}">Edit</button>
								<button class="btn-delete btn btn-sm btn-outline-danger" data-comment_id="{{ comment.id }}">Delete</button>
							{% endif %}
						</div>
					</div>
				</div>
			{% else %}
				<p class="text-muted fst-italic">No comments yet. Be the first to share your thoughts!</p>
			{% endfor %}

			<hr class="my-4"/>

			<h3 class="mb-3">Leave a Comment</h3>
			{{ form_start(form) }}
                <div class="mb-3" id="commentForm">
                    {{ form_row(form.content) }}
                </div>
                <div class="mb-3" id="submitButton">
                    {{ form_row(form.save) }}
                </div>
			{{ form_end(form) }}
		</div>
	</section>
{% endblock %}

{% block script %}
    <script src="{{ asset('js/comment.js') }}"></script>
{% endblock %}
